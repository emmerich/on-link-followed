{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 2a293ab2087859f1cacb","webpack:///./src/on-link-followed.js","webpack:///./src/aTags.js","webpack:///./src/windowOpen.js","webpack:///./src/historyState.js"],"names":[],"mappings":"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","file":"on-link-followed.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"onLinkFollowed\"] = factory();\n\telse\n\t\troot[\"onLinkFollowed\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2a293ab2087859f1cacb\n **/","import { attach as attachToATags, detach as detachFromATags } from './aTags'\nimport { attach as attachToWindowOpen, detach as detachFromWindowOpen } from './windowOpen'\nimport { attach as attachToHistoryPushAndReplaceState, detach as detachFromHistoryPushAndReplaceState } from './historyState'\n\nconst attachToAll = (win, rootNode, emitter) => {\n  // Attach to A tags\n  attachToATags(win, rootNode, emitter)\n\n  // Overwrite window.open\n  attachToWindowOpen(win, rootNode, emitter)\n\n  // Overwrite history.pushState / history.replaceState\n  attachToHistoryPushAndReplaceState(win, rootNode, emitter)\n\n  // Attach to onbeforeunload\n  // set window.location\n  // window.onpopstate?\n  // history.forward / history.back / history.go?\n  // Copy & paste url? - will do onbeforeunload\n}\n\nconst detachFromAll = (win, rootNode) => {\n  detachFromATags(win, rootNode)\n  detachFromWindowOpen(win, rootNode)\n  detachFromHistoryPushAndReplaceState(win, rootNode)\n}\n\nconst onLinkFollowed = (win, rootNode) => {\n  const emitter = {\n    emit: (data) => console.log(data)\n  }\n\n  // internal object for storing state\n  win._emmerich_olf = {\n    listeners: []\n  }\n\n  attachToAll(win, rootNode, emitter)\n\n  return {\n    on(listener) {\n      win._emmerich_olf.listeners = win._emmerich_olf.listeners.concat(listener)\n      return win._emmerich_olf.listeners.length - 1\n    }\n  }\n};\n\nconst offLinkFollowed = (win, rootNode) => {\n  detachFromAll(win, rootNode)\n  win._emmerich_olf = null\n  delete win._emmerich_olf\n}\n\nexport default {\n  initWithWindow(win, rootNode) {\n    return onLinkFollowed(win, rootNode)\n  },\n\n  init() {\n    return this.initWithWindow(window, window.document.body)\n  },\n\n  removeFromWindow(win, rootNode) {\n    return offLinkFollowed(win, rootNode)\n  },\n\n  remove() {\n    return this.removeFromWindow(window, window.document.body)\n  }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/on-link-followed.js\n **/","const A_TAG = 'A_TAG'\nconst RIGHT_CLICK = 2\n\nconst getLinkFollowedPacket = (ev) => {\n  // ev.target references the element that was clicked, but ev.currentTarget\n  // references the element that we attached the event handler to, so we know\n  // its an a tag\n  return {\n    destination: ev.currentTarget.href,\n    type: A_TAG,\n    params: {\n      element: ev.currentTarget,\n      target: ev.target\n    }\n  }\n}\n\nconst onMouseDown = (emitter) => (ev) => {\n  if(ev.button === RIGHT_CLICK) {\n    emitter.emit('onMaybeLinkFollowed', getLinkFollowedPacket(ev))\n  }\n}\n\nconst onClick = (emitter) => (ev) => {\n  emitter.emit('onLinkFollowed', getLinkFollowedPacket(ev))\n}\n\nconst forEachATag = (rootNode, fn) => {\n  const aTags = rootNode.getElementsByTagName('a')\n\n  for(let i = 0; i < aTags.length; i++) {\n    fn(aTags[i], i)\n  }\n}\n\nexport const attach = (win, rootNode, emitter) => {\n  win._emmerich_olf._aTagListeners = []\n\n  forEachATag(rootNode, (a) => {\n    const clickListener = onClick(emitter)\n    const mdListener = onMouseDown(emitter)\n\n    win._emmerich_olf._aTagListeners.push([a, [\n      ['click', clickListener], ['mousedown', mdListener]]])\n\n    a.addEventListener('click', clickListener)\n    a.addEventListener('mousedown', mdListener)\n  })\n}\n\nexport const detach = (win, rootNode) => {\n  win._emmerich_olf._aTagListeners.forEach(([node, listeners]) => {\n    listeners.forEach(([name, handler]) => {\n      node.removeEventListener(name, handler)\n    })\n  })\n\n  win._emmerich_olf._aTagListeners = []\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/aTags.js\n **/","const WINDOW_OPEN = 'WINDOW_OPEN'\n\nconst wrappedWindowOpen = (win, emitter) => (url, target, args) => {\n  emitter.emit('onLinkFollowed', { destination: url, type: WINDOW_OPEN })\n  win._emmerich_olf.winOpen.call(win, url, target, args)\n}\n\nexport const attach = (win, rootNode, emitter) => {\n  win._emmerich_olf.winOpen = win.open\n  win.open = wrappedWindowOpen(win, emitter)\n}\n\nexport const detach = (win, rootNode, emitter) => {\n  win.open = win._emmerich_olf.winOpen\n  win._emmerich_olf.winOpen = null\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/windowOpen.js\n **/","const HISTORY_PUSHSTATE = 'HISTORY_PUSHSTATE'\nconst HISTORY_REPLACESTATE = 'HISTORY_REPLACESTATE'\n\nconst wrapped = (win, emitter, method, type) => (state, title, url) => {\n  try {\n    method.call(win.history, state, title, url)\n  } catch (err) {\n    // pushState / replaceState will throw an exception if the domain cannot\n    // be reached. If that happens we don't want to fire onLinkFollowed, we\n    // want to rethrow the exception\n    throw err\n  }\n\n  emitter.emit('onLinkFollowed', { destination: window.location.href, type })\n}\n\nexport const attach = (win, rootNode, emitter) => {\n  win._emmerich_olf.historyPushState = win.history.pushState\n  win._emmerich_olf.historyReplaceState = win.history.replaceState\n\n  win.history.pushState = wrapped(win, emitter, win._emmerich_olf.historyPushState, HISTORY_PUSHSTATE)\n  win.history.replaceState = wrapped(win, emitter, win._emmerich_olf.historyReplaceState, HISTORY_REPLACESTATE)\n}\n\nexport const detach = (win, rootNode) => {\n  win.history.pushState = win._emmerich_olf.historyPushState\n  win.history.replaceState = win._emmerich_olf.historyReplaceState\n\n  win._emmerich_olf.historyPushState = null\n  win._emmerich_olf.historyReplaceState = null\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/historyState.js\n **/"],"sourceRoot":""}